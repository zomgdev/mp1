# Изменения

Дата: 2026-02-12

1. Реорганизованы модели:
   - Добавлен файл `internal/model/scheme.go`.
   - Структуры дерева и схемы вынесены в отдельный пакет.
   - Добавлены `NewDefaultScheme` и `NormalizeScheme` для стабильной нормализации схемы.

2. Выделен слой файлового хранилища:
   - Добавлен `internal/storage/filejson/json.go` с общими функциями чтения/записи JSON.
   - Добавлен `internal/storage/filejson/tree_repo.go` для загрузки данных дерева.
   - Добавлен `internal/storage/filejson/scheme_repo.go` для загрузки/сохранения текущей схемы.

3. HTTP-обработчики разделены по ответственности:
   - Добавлен `internal/httpapi/handlers/tree.go` для `GET /api/tree`.
   - Добавлен `internal/httpapi/handlers/scheme.go` для `GET/POST /api/scheme/current`.
   - Добавлен `internal/httpapi/handlers/helpers.go` для JSON-ответов.
   - Добавлена проверка методов и ограничение размера тела запроса для обновления схемы.

4. Добавлен пакет роутера:
   - Добавлен `internal/httpapi/router.go`.
   - Централизована регистрация API-эндпоинтов и статических файлов.

5. Упрощен вход в приложение:
   - Обновлен `main.go`: оставлены только сборка зависимостей и запуск сервера.
   - Добавлена явная конфигурация `http.Server` и обработка ошибки запуска.

6. Проверка:
   - Выполнен `gofmt` для обновленных Go-файлов.
   - Выполнен `go test ./...` (все пакеты проходят, тестовых файлов пока нет).
